# Quy Táº¯c Sá»­ Dá»¥ng MCP Linux Command Executor

*Mod by Fong on 2025-07-24--12-16-PM*
*Mod by Fong on 2025-07-24--12-20-PM*

## Má»¥c ÄÃ­ch

Quy táº¯c nÃ y hÆ°á»›ng dáº«n chi tiáº¿t khi nÃ o nÃªn sá»­ dá»¥ng MCP Linux Command Executor vÃ  khi nÃ o khÃ´ng, dá»±a trÃªn phÃ¢n tÃ­ch codebase vÃ  bÃ i há»c kinh nghiá»‡m tá»« dá»± Ã¡n.

## PhÃ¢n TÃ­ch MCP Linux Command Executor

### Cáº¥u TrÃºc vÃ  TÃ­nh NÄƒng
- **Tool chÃ­nh**: `mcp_fong-linux-command-executor_runLinuxCommand`
- **MÃ´ táº£**: Thá»±c thi lá»‡nh Linux khÃ´ng-sudo vÃ  lÆ°u output vÃ o log file
- **YÃªu cáº§u báº¯t buá»™c**: `working_directory` parameter (Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i)
- **Háº¡n cháº¿**: Chá»‰ há»— trá»£ lá»‡nh khÃ´ng-sudo

### Danh SÃ¡ch Lá»‡nh Bá»‹ Cháº·n (deny_list.json)
```json
[
  "rm",
  "mv"
]
```

### Äáº·c Äiá»ƒm Ká»¹ Thuáº­t
- **Logging**: Tá»± Ä‘á»™ng lÆ°u output vÃ o `/home/fong/Projects/MCPs/fong_linux_command_executor/logc/`
- **Truncation**: Output >300 dÃ²ng sáº½ bá»‹ cáº¯t, chá»‰ hiá»ƒn thá»‹ 300 dÃ²ng cuá»‘i
- **Error Handling**: Xá»­ lÃ½ lá»—i chi tiáº¿t vá»›i status codes
- **Security**: Kiá»ƒm tra deny list trÆ°á»›c khi thá»±c thi

## Khi NÃ o DÃ™NG MCP Linux Command Executor

### âœ… NÃªn DÃ¹ng Cho

1. **Lá»‡nh thÃ´ng tin vÃ  kiá»ƒm tra**:
   ```bash
   # File system exploration - Æ¯U TIÃŠN dÃ¹ng tree thay vÃ¬ ls
   tree -L 3 /path/to/directory
   tree -p /path/to/directory  # Hiá»ƒn thá»‹ permissions
   tree -a /path/to/directory  # Bao gá»“m hidden files
   
   # Chá»‰ dÃ¹ng ls khi cáº§n thÃ´ng tin chi tiáº¿t cá»¥ thá»ƒ
   ls -la /path/to/directory
   find /path -name "*.txt"
   
   # System information
   pwd
   whoami
   date
   uname -a
   ```

2. **Lá»‡nh Ä‘á»c vÃ  phÃ¢n tÃ­ch**:
   ```bash
   # File reading
   head -20 /path/to/file
   tail -10 /path/to/file
   wc -l /path/to/file
   
   # Content analysis
   grep -n "pattern" /path/to/file
   sed -n '1,50p' /path/to/file
   awk '{print $1}' /path/to/file
   ```

3. **Lá»‡nh tÃ¬m kiáº¿m vÃ  lá»c**:
   ```bash
   # Search operations
   grep -r "keyword" /path/to/directory
   find /path -type f -name "*.py"
   locate filename
   ```

4. **Lá»‡nh kiá»ƒm tra tráº¡ng thÃ¡i**:
   ```bash
   # Status checks
   ps aux | grep process_name
   df -h
   free -h
   systemctl status service_name
   ```

5. **Lá»‡nh network vÃ  web**:
   ```bash
   # Network operations
   curl -I https://example.com
   ping -c 3 google.com
   wget --spider https://example.com
   ```

### âŒ KHÃ”NG DÃ¹ng Cho

1. **Git Commands** (Báº®T BUá»˜C):
   ```bash
   # âŒ KHÃ”NG dÃ¹ng MCP cho:
   git add .
   git commit -m "message"
   git push origin main
   git status
   git log
   
   # âœ… DÃ¹ng run_terminal_cmd thay vÃ¬ MCP
   ```

2. **Lá»‡nh cÃ³ sudo**:
   ```bash
   # âŒ KHÃ”NG dÃ¹ng MCP cho:
   sudo apt update
   sudo systemctl restart service
   sudo chmod 755 file
   ```

3. **Lá»‡nh nguy hiá»ƒm** (Ä‘Ã£ bá»‹ cháº·n):
   ```bash
   # âŒ Bá»‹ cháº·n trong deny_list.json:
   rm -rf /path/to/directory
   mv /path/to/file /new/location
   ```

4. **Lá»‡nh tÆ°Æ¡ng tÃ¡c**:
   ```bash
   # âŒ KHÃ”NG dÃ¹ng MCP cho:
   nano /path/to/file
   vim /path/to/file
   less /path/to/file
   ```

5. **Lá»‡nh cáº§n authentication**:
   ```bash
   # âŒ KHÃ”NG dÃ¹ng MCP cho:
   ssh user@host
   scp file user@host:/path
   rsync -avz /source/ user@host:/dest/
   ```

## Quy TrÃ¬nh Lá»±a Chá»n Tool

### BÆ°á»›c 1: PhÃ¢n Loáº¡i Lá»‡nh
```bash
# Kiá»ƒm tra loáº¡i lá»‡nh
if [[ $command == git* ]]; then
    echo "Git command -> DÃ¹ng run_terminal_cmd"
elif [[ $command == sudo* ]]; then
    echo "Sudo command -> DÃ¹ng system terminal"
elif [[ $command =~ ^(rm|mv)$ ]]; then
    echo "Dangerous command -> Bá»‹ cháº·n"
else
    echo "Safe command -> CÃ³ thá»ƒ dÃ¹ng MCP"
fi
```

### BÆ°á»›c 2: Kiá»ƒm Tra YÃªu Cáº§u
- **working_directory**: MCP yÃªu cáº§u Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i
- **Authentication**: Lá»‡nh cáº§n auth khÃ´ng dÃ¹ng MCP
- **Interactive**: Lá»‡nh tÆ°Æ¡ng tÃ¡c khÃ´ng dÃ¹ng MCP

### BÆ°á»›c 3: Chá»n Tool PhÃ¹ Há»£p
1. **Git commands**: `run_terminal_cmd`
2. **Sudo commands**: System terminal
3. **Safe commands**: `mcp_fong-linux-command-executor_runLinuxCommand`
4. **File operations**: `mcp_fong-long-file-reader_readFileWithCommands`

## Best Practices

### 1. LuÃ´n Kiá»ƒm Tra TrÆ°á»›c
```bash
# Kiá»ƒm tra file tá»“n táº¡i trÆ°á»›c khi Ä‘á»c
if [ -f "/path/to/file" ]; then
    # DÃ¹ng MCP Ä‘á»ƒ Ä‘á»c
else
    # BÃ¡o lá»—i
fi
```

### 2. Sá»­ Dá»¥ng ÄÆ°á»ng Dáº«n Tuyá»‡t Äá»‘i
```bash
# âœ… ÄÃºng
working_directory: "/home/fong/Projects/my-project"

# âŒ Sai
working_directory: "./my-project"
```

### 3. Æ¯u TiÃªn Tree Thay VÃ¬ Ls
```bash
# âœ… Æ¯u tiÃªn dÃ¹ng tree
tree -L 2 /path/to/directory
tree -p /path/to/directory  # Hiá»ƒn thá»‹ permissions
tree -a /path/to/directory  # Bao gá»“m hidden files

# âŒ Chá»‰ dÃ¹ng ls khi cáº§n thÃ´ng tin chi tiáº¿t cá»¥ thá»ƒ
ls -la /path/to/directory
ls -lh /path/to/directory  # Human readable sizes
```

### 4. Xá»­ LÃ½ Output DÃ i
```bash
# MCP tá»± Ä‘á»™ng truncate output >300 dÃ²ng
# Kiá»ƒm tra output_note Ä‘á»ƒ biáº¿t cÃ³ bá»‹ cáº¯t khÃ´ng
```

### 5. Error Handling
```bash
# LuÃ´n kiá»ƒm tra status trong response
if response["status"] == "success":
    # Xá»­ lÃ½ output
else:
    # Xá»­ lÃ½ lá»—i
```

## VÃ­ Dá»¥ Thá»±c Táº¿

### âœ… VÃ­ Dá»¥ ÄÃºng
```python
# File system exploration - Æ¯U TIÃŠN tree
mcp_fong-linux-command-executor_runLinuxCommand(
    command="tree -L 2 /home/fong/Projects",
    working_directory="/home/fong/Projects"
)

# Tree vá»›i permissions
mcp_fong-linux-command-executor_runLinuxCommand(
    command="tree -p -L 1 /home/fong/Projects",
    working_directory="/home/fong/Projects"
)

# Content analysis
mcp_fong-linux-command-executor_runLinuxCommand(
    command="grep -n 'function' /path/to/file.js",
    working_directory="/home/fong/Projects"
)
```

### âŒ VÃ­ Dá»¥ Sai
```python
# Git commands - KHÃ”NG dÃ¹ng MCP
run_terminal_cmd("git add . && git commit -m 'update'")

# Sudo commands - KHÃ”NG dÃ¹ng MCP
# DÃ¹ng system terminal trá»±c tiáº¿p

# Dangerous commands - Bá»‹ cháº·n
# rm, mv commands sáº½ bá»‹ tá»« chá»‘i
```

## Troubleshooting

### Lá»—i ThÆ°á»ng Gáº·p

1. **Working directory khÃ´ng tá»“n táº¡i**:
   ```
   Error: Working directory '/invalid/path' does not exist
   Solution: Kiá»ƒm tra Ä‘Æ°á»ng dáº«n vÃ  dÃ¹ng Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i
   ```

2. **Command bá»‹ cháº·n**:
   ```
   Error: Command 'rm' is on the deny list and was blocked
   Solution: DÃ¹ng lá»‡nh thay tháº¿ hoáº·c system terminal
   ```

3. **Output bá»‹ truncate**:
   ```
   Output is truncated to the last 300 lines
   Solution: Kiá»ƒm tra log file Ä‘á»ƒ xem output Ä‘áº§y Ä‘á»§
   ```

### Debug Commands
```bash
# Kiá»ƒm tra MCP status
echo "MCP Linux Command Executor Status: OK"

# Test basic command
mcp_fong-linux-command-executor_runLinuxCommand(
    command="pwd",
    working_directory="/home/fong"
)
```

## TÃ³m Táº¯t Quy Táº¯c

### ğŸ¯ NguyÃªn Táº¯c Cá»‘t LÃµi
1. **Git = Terminal trá»±c tiáº¿p** (run_terminal_cmd)
2. **Sudo = System terminal**
3. **Safe commands = MCP**
4. **Dangerous commands = Bá»‹ cháº·n**
5. **Tree > Ls** (Æ¯u tiÃªn tree cho file system exploration)

### ğŸ“‹ Checklist TrÆ°á»›c Khi DÃ¹ng MCP
- [ ] KhÃ´ng pháº£i Git command
- [ ] KhÃ´ng cÃ³ sudo
- [ ] KhÃ´ng pháº£i lá»‡nh nguy hiá»ƒm (rm, mv)
- [ ] CÃ³ Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i cho working_directory
- [ ] KhÃ´ng cáº§n authentication
- [ ] KhÃ´ng pháº£i lá»‡nh tÆ°Æ¡ng tÃ¡c
- [ ] Æ¯u tiÃªn dÃ¹ng `tree` thay vÃ¬ `ls` cho file system exploration

### ğŸ”„ Workflow
1. PhÃ¢n tÃ­ch loáº¡i lá»‡nh
2. Kiá»ƒm tra yÃªu cáº§u
3. Chá»n tool phÃ¹ há»£p
4. Thá»±c thi vÃ  xá»­ lÃ½ káº¿t quáº£

---

**LÆ°u Ã½**: Quy táº¯c nÃ y dá»±a trÃªn phÃ¢n tÃ­ch codebase MCP vÃ  bÃ i há»c kinh nghiá»‡m tá»« dá»± Ã¡n ubuntu-lenovo-t14. LuÃ´n cáº­p nháº­t khi cÃ³ thay Ä‘á»•i trong MCP configuration.
description:
globs:
alwaysApply: false
---
